<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Security Questions</h4>
                <div *ngIf="folderLevelsValid" class="btn btn-success right"
                     (click)="createQuestionModal(modalCreateQuestions)">
                    Add Questions
                </div>
                <div class="table-responsive-sm m-t-40">
                    <table datatable [dtOptions]="gridConfig" [dtTrigger]="gridTrigger" id="bundlesTable"
                           class="display nowrap table table-hover table-striped table-bordered"
                           cellspacing="0" width="100%">
                        <thead>
                        <tr>
                            <th>#</th>
                            <th>Question</th>
                            <th>Answer</th>
                            <th>Action</th>
                        </tr>
                        </thead>
                        <tbody *ngIf="securityQuestionsList?.length > 0">
                        <tr *ngFor="let sql of securityQuestionsList; let i = index;">
                            <td>{{i + 1}}</td>
                            <td>{{sql.question}}</td>
                            <td>{{sql.answer}}</td>
                            <td>
                                <div class="btn btn-success"
                                     (click)="editQuestionModal(i, modalEditQuestions)">
                                    Edit
                                </div>
                                <div class="btn btn-danger"
                                     (click)="deleteQuestion(i,modalDeleteTemplate)">
                                    Delete
                                </div>
                            </td>
                        </tr>
                        <tr *ngIf="securityQuestionsList?.length == 0">
                            <td colspan="4" class="no-data-available">No data!</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>


<ng-template #modalCreateQuestions let-c="close" let-d="dismiss">
    <div class="modal-header">
        <h4 class="modal-title">Create new security questions</h4>
        <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <form name="form" (ngSubmit)="createSecurityQuestions()" novalidate>
        <div class="modal-body">
            <div class="form-group">
                <table class="table table-bordered table-hover table-condensed grid_tbl">
                    <tr style="font-weight: bold">
                        <td>Index</td>
                        <td>Question</td>
                        <td>Answer</td>
                        <td>Action</td>
                    </tr>
                    <!--<tr ng-repeat="prProduct in prdc.currentPR.products">-->
                    <tr *ngFor="let qa of questionsArray;  trackBy:indexTracker; let i = index; ">
                        <td>
                            {{i+1}}
                        </td>
                        <td>
                            {{qa | json}}
                        </td>
                        <td>
                            <input type="text"
                                   placeholder="Question"
                                   class="form-control"
                                   name="question{{i}}"
                                   value
                                   [(ngModel)]="qa.question">
                        </td>
                        <td>
                            <input type="text"
                                   placeholder="Answer"
                                   class="form-control"
                                   name="answer{{i}}"
                                   [(ngModel)]="qa.answer">
                        </td>
                        <td>
                            <div data-toggle="tooltip"
                                 class="btn btn-danger"
                                 data-original-title="Close"
                                 (click)="removeQuestion(qa)">
                                <i class="fa fa-close fa-lg"></i>
                            </div>
                        </td>
                    </tr>
                </table>
                <div class="btn btn-success"
                     (click)="addQuestion()">
                    <i class="fa fa-plus-circle fa-lg"></i> Add
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="submit" class="btn btn-primary">Create</button>
        </div>
    </form>
</ng-template>

<ng-template #modalEditQuestions let-c="close" let-d="dismiss">
    <div class="modal-header">
        <h4 class="modal-title">Update security question</h4>
        <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <form name="form" (ngSubmit)="editQuestion()" novalidate>
        <div class="modal-body">
            <div class="form-group">
                <table class="table table-bordered table-hover table-condensed grid_tbl">
                    <tr style="font-weight: bold">
                        <td>Question</td>
                        <td>Answer</td>
                    </tr>
                    <tr>
                        <td>
                            <input type="text"
                                   placeholder="Question"
                                   class="form-control"
                                   name="editQuestion"
                                   [(ngModel)]="eQuestion">
                        </td>
                        <td>
                            <input type="text"
                                   placeholder="Answer"
                                   class="form-control"
                                   name="editAnswer"
                                   [(ngModel)]="eAnswer">
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="modal-footer">
            <button type="submit" class="btn btn-primary">Update</button>
        </div>
    </form>
</ng-template>


<!--DeleteModal-->
<ng-template #modalDeleteTemplate>
    <div class="modal-header">
        <h4 class="modal-title">Delete Question</h4>
        <button type="button" class="close" aria-label="Close"
                (click)="modalRef.dismiss({cb: cancelCB, result: false});">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <p>Do you want to delete the selected Question ?</p>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-success" (click)="modalRef.dismiss({cb: cancelCB, result: false});">
            No
        </button>
        <button type="submit" class="btn btn-danger" (click)="modalRef.close({cb: okayCB, result: true});">
            Yes
        </button>
    </div>
</ng-template>
